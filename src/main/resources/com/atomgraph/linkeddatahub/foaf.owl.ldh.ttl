@base           <http://xmlns.com/foaf/0.1/> .

@prefix :       <> .
@prefix rdf:	<http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs:	<http://www.w3.org/2000/01/rdf-schema#> .
@prefix ldh:	<https://w3id.org/atomgraph/linkeddatahub#> .
@prefix sp:	<http://spinrdf.org/sp#> .
@prefix spin:	<http://spinrdf.org/spin#> .
@prefix cert:   <http://www.w3.org/ns/auth/cert#> .

: rdfs:label "Friend of a Friend (FOAF) vocabulary" .

# AGENT

:Agent spin:constructor :AgentConstructor .
    # spin:constraint :MissingCertKey ; # Agent has either PublicKey or UserAccount

:MissingCertKey a ldh:MissingPropertyValue ;
    rdfs:label "Missing cert:key" ;
    sp:arg1 cert:key .

:AgentConstructor a sp:Construct ;
    rdfs:label "Agent constructor" ;
    sp:text """
        PREFIX rdfs:    <http://www.w3.org/2000/01/rdf-schema#>
        PREFIX xsd:     <http://www.w3.org/2001/XMLSchema#>
        PREFIX acl:     <http://www.w3.org/ns/auth/acl#>
        PREFIX cert:    <http://www.w3.org/ns/auth/cert#>

        CONSTRUCT {
            ?this cert:key [ a cert:PublicKey ] ;
                acl:delegates [ a rdfs:Resource ] .
        }
        WHERE {}""" .

# PERSON

:Person spin:constructor :PersonConstructor ;
    spin:constraint :MissingGivenName, :MissingFamilyName, :MissingBasedNear, :MissingMbox .

:MissingGivenName a ldh:MissingPropertyValue ;
    rdfs:label "Missing foaf:givenName" ;
    sp:arg1 :givenName .

:MissingFamilyName a ldh:MissingPropertyValue ;
    rdfs:label "Missing foaf:familyName" ;
    sp:arg1 :familyName .

:MissingBasedNear a ldh:MissingPropertyValue ;
    rdfs:label "Missing foaf:based_near" ;
    sp:arg1 :based_near .

:MissingMbox a ldh:MissingPropertyValue ;
    rdfs:label "Missing foaf:mbox" ;
    sp:arg1 :mbox .

:PersonConstructor a sp:Construct ;
    rdfs:label "Person constructor" ;
    sp:text """
        PREFIX rdfs:    <http://www.w3.org/2000/01/rdf-schema#>
        PREFIX foaf:    <http://xmlns.com/foaf/0.1/>
        PREFIX xsd:     <http://www.w3.org/2001/XMLSchema#>
        PREFIX vivo:    <http://vivoweb.org/ontology/core#>

        CONSTRUCT {
            ?this foaf:givenName [ a xsd:string ] ;
                foaf:familyName [ a xsd:string ] ;
                foaf:mbox [ a rdfs:Resource ] ;
                foaf:based_near [ a rdfs:Resource ] ;
                vivo:orcidId [ a rdfs:Resource ] .
        }
        WHERE {}""" .

# GROUP

:Group spin:constructor :GroupConstructor ;
    spin:constraint [ a ldh:MissingPropertyValue ;
        rdfs:label "Missing name" ;
        sp:arg1 :name
    ] .

:GroupConstructor a sp:Construct ;
    rdfs:label "Group constructor" ;
    sp:text """
        PREFIX xsd:     <http://www.w3.org/2001/XMLSchema#>
        PREFIX foaf:    <http://xmlns.com/foaf/0.1/>
        PREFIX dct:     <http://purl.org/dc/terms/>

        CONSTRUCT {
            ?this foaf:name [ a xsd:string ] ;
                dct:description [ a xsd:string ] ;
                foaf:member [ a foaf:Agent ] .
        }
        WHERE {}""" .