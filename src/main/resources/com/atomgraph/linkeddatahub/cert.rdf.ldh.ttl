@base           <http://www.w3.org/ns/auth/cert> .

@prefix :       <#> .
@prefix rdf:	<http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs:	<http://www.w3.org/2000/01/rdf-schema#> .
@prefix ldh:	<https://w3id.org/atomgraph/linkeddatahub#> .
@prefix sp:	<http://spinrdf.org/sp#> .
@prefix spin:	<http://spinrdf.org/spin#> .

# PUBLIC KEY

:PublicKey spin:constructor :PublicKeyConstructor ;
    spin:constraint :MissingCertModulus, :MissingCertExponent .

:PublicKeyConstructor a sp:Construct ;
    rdfs:label "Public key constructor" ;
    sp:text """
        PREFIX xsd:     <http://www.w3.org/2001/XMLSchema#>
        PREFIX cert:    <http://www.w3.org/ns/auth/cert#>

        CONSTRUCT {
            ?this cert:modulus [ a xsd:hexBinary ] ;
                cert:exponent 65537 .
        }
        WHERE {}""" ;
    rdfs:isDefinedBy : .

:MissingCertModulus a ldh:MissingPropertyValue ;
    rdfs:label "Missing cert:modulus" ;
    sp:arg1 :modulus .

:MissingCertExponent a ldh:MissingPropertyValue ;
    rdfs:label "Missing cert:exponent" ;
    sp:arg1 :exponent .