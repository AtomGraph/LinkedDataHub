@prefix :	<ns#> .
@prefix rdf:	<http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs:	<http://www.w3.org/2000/01/rdf-schema#> .
@prefix xsd:	<http://www.w3.org/2001/XMLSchema#> .
@prefix owl:	<http://www.w3.org/2002/07/owl#> .
@prefix ldt:	<https://www.w3.org/ns/ldt#> .
@prefix dh:	<https://www.w3.org/ns/ldt/document-hierarchy/domain#> .
@prefix sp:	<http://spinrdf.org/sp#> .
@prefix spin:	<http://spinrdf.org/spin#> .
@prefix sioc:	<http://rdfs.org/sioc/ns#> .
@prefix foaf:	<http://xmlns.com/foaf/0.1/> .
@prefix lacl:	<https://w3id.org/atomgraph/linkeddatahub/admin/acl/domain#> .
@prefix lsm:	<https://w3id.org/atomgraph/linkeddatahub/admin/sitemap/domain#> .
@prefix apl:	<https://w3id.org/atomgraph/linkeddatahub/domain#> .
@prefix dct:	<http://purl.org/dc/terms/> .

: a owl:Ontology ;
    foaf:isPrimaryTopicOf <ns> ;
    owl:imports apl:, lacl:, lsm: ;
    owl:versionInfo "1.1.4" ;
    rdfs:label "Admin ontology" ;
    rdfs:comment "AtomGraph admin application ontology" .

:Container a rdfs:Class ;
    rdfs:subClassOf dh:Container ;
    spin:constructor :DocumentConstructor ;
    # spin:constraint :MissingTitle ;
    apl:template :ContainerChildren ;
    rdfs:label "Container" ;
    rdfs:isDefinedBy : .

:ContainerChildren a apl:Content ;
    rdf:first :SelectChildren ;
    rdf:rest rdf:nil ;
    rdfs:label "Container children" ;
    rdfs:isDefinedBy : .

:SelectChildren a sp:Select ;
    rdfs:label "Select children" ;
    sp:text """
PREFIX  dct:  <http://purl.org/dc/terms/>
PREFIX  foaf: <http://xmlns.com/foaf/0.1/>
PREFIX  sioc: <http://rdfs.org/sioc/ns#>

SELECT DISTINCT  ?child ?thing
WHERE
{ GRAPH ?childGraph
  {   { ?child  sioc:has_parent  ?this }
    UNION
      { ?child  sioc:has_container  ?this }
    ?child  a                     ?Type
    OPTIONAL
      { ?child  dct:title  ?title }
    OPTIONAL
      { ?child  foaf:primaryTopic  ?thing }
  }
}
ORDER BY ?title
""" ;
    rdfs:isDefinedBy : .

:Item a rdfs:Class ;
    rdfs:subClassOf dh:Item ;
    spin:constructor :DocumentConstructor ;
    # spin:constraint :MissingTitle ;
    rdfs:label "Item" ;
    rdfs:isDefinedBy : .

:DocumentConstructor a sp:Construct ;
    sp:text """
        PREFIX rdf:     <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
        PREFIX xsd:     <http://www.w3.org/2001/XMLSchema#>
        PREFIX dct:     <http://purl.org/dc/terms/>

        CONSTRUCT {
          ?this dct:title [ a xsd:string ] ;
              dct:description [ a xsd:string ] .
        }
        WHERE {}""" ;
    rdfs:label "Document constructor" ;
    rdfs:isDefinedBy : .

:MissingTitle a apl:MissingPropertyValue ;
    sp:arg1 dct:title ;
    rdfs:label "Missing title" ;
    rdfs:isDefinedBy : .

:Class a rdfs:Class ;
    rdfs:subClassOf lsm:Class, :TopicOfClassItem ;
    ldt:path "{isPrimaryTopicOf.slug}/" ;
    ldt:fragment "this" ;
    rdfs:label "Class" ;
    rdfs:isDefinedBy : .

:ClassItem a rdfs:Class ;
    rdfs:subClassOf :Item, :ItemOfClassContainer ;
    rdfs:label "Class item" ;
    rdfs:isDefinedBy : .

:TopicOfClassItem a owl:Restriction ;
    owl:onProperty foaf:isPrimaryTopicOf ;
    owl:allValuesFrom :ClassItem ;
    rdfs:label "Topic of class item" ;
    rdfs:isDefinedBy : .

:ItemOfClassContainer a owl:Restriction ;
    owl:onProperty sioc:has_container ;
    owl:hasValue <model/classes/> ;
    rdfs:label "Has class container" ;
    rdfs:isDefinedBy : .

:Property a rdfs:Class ;
    rdfs:subClassOf lsm:Property, :TopicOfPropertyItem ;
    ldt:path "{isPrimaryTopicOf.slug}/" ;
    ldt:fragment "this" ;
    rdfs:label "Property" ;
    rdfs:isDefinedBy : .

:PropertyItem a rdfs:Class ;
    rdfs:subClassOf :Item, :ItemOfPropertyContainer ;
    rdfs:label "Property item" ;
    rdfs:isDefinedBy : .

:TopicOfPropertyItem a owl:Restriction ;
    owl:onProperty foaf:isPrimaryTopicOf ;
    owl:allValuesFrom :PropertyItem ;
    rdfs:label "Topic of property item" ;
    rdfs:isDefinedBy : .

:ItemOfPropertyContainer a owl:Restriction ;
    owl:onProperty sioc:has_container ;
    owl:hasValue <model/properties/> ;
    rdfs:label "Has property container" ;
    rdfs:isDefinedBy : .

:Query a rdfs:Class ;
    rdfs:subClassOf lsm:Query, :TopicOfQueryItem ;
    ldt:path "{isPrimaryTopicOf.slug}/" ;
    ldt:fragment "this" ;
    rdfs:label "Query" ;
    rdfs:isDefinedBy : .

:Construct a rdfs:Class ;
    rdfs:subClassOf :Query, lsm:Construct, :TopicOfQueryItem ;
    rdfs:label "CONSTRUCT" ;
    rdfs:isDefinedBy : .

:Describe a rdfs:Class ;
    rdfs:subClassOf :Query, lsm:Describe, :TopicOfQueryItem ;
    rdfs:label "DESCRIBE" ;
    rdfs:isDefinedBy : .

:Select a rdfs:Class ;
    rdfs:subClassOf :Query, :TopicOfQueryItem ;
    rdfs:label "SELECT" ;
    rdfs:isDefinedBy : .

:Ask a rdfs:Class ;
    rdfs:subClassOf :Query, :TopicOfQueryItem ;
    rdfs:label "ASK" ;
    rdfs:isDefinedBy : .

:QueryItem a rdfs:Class ;
    rdfs:subClassOf :Item, :ItemOfQueryContainer ;
    rdfs:label "Query item" ;
    rdfs:isDefinedBy : .

:TopicOfQueryItem a owl:Restriction ;
    owl:onProperty foaf:isPrimaryTopicOf ;
    owl:allValuesFrom :QueryItem ;
    rdfs:label "Topic of query item" ;
    rdfs:isDefinedBy : .

:ItemOfQueryContainer a owl:Restriction ;
    owl:onProperty sioc:has_container ;
    owl:hasValue <model/queries/> ;
    rdfs:label "Has query container" ;
    rdfs:isDefinedBy : .

:MissingPropertyValue a rdfs:Class ;
    rdfs:subClassOf lsm:MissingPropertyValue, :TopicOfConstraintItem ;
    ldt:path "{isPrimaryTopicOf.slug}/" ;
    ldt:fragment "this" ;
    rdfs:label "Missing property value" ;
    rdfs:isDefinedBy : .

:ConstraintItem a rdfs:Class ;
    rdfs:subClassOf :Item, :ItemOfConstraintContainer ;
    rdfs:label "Missing property value item" ;
    rdfs:isDefinedBy : .

:TopicOfConstraintItem a owl:Restriction ;
    owl:onProperty foaf:isPrimaryTopicOf ;
    owl:allValuesFrom :ConstraintItem ;
    rdfs:label "Topic of missing property value item" ;
    rdfs:isDefinedBy : .

:ItemOfConstraintContainer a owl:Restriction ;
    owl:onProperty sioc:has_container ;
    owl:hasValue <model/constraints/> ;
    rdfs:label "Has class container" ;
    rdfs:isDefinedBy : .

:Ontology a rdfs:Class ;
    rdfs:subClassOf lsm:Ontology, :TopicOfOntologyItem ;
    ldt:path "{isPrimaryTopicOf.slug}/" ;
    ldt:fragment "this" ;
    rdfs:label "Ontology" ;
    rdfs:isDefinedBy : .

:OntologyItem a rdfs:Class ;
    rdfs:subClassOf :Item, :ItemOfOntologyContainer ;
    rdfs:label "Ontology item" ;
    rdfs:isDefinedBy : .

:TopicOfOntologyItem a owl:Restriction ;
    owl:onProperty foaf:isPrimaryTopicOf ;
    owl:allValuesFrom :OntologyItem ;
    rdfs:label "Topic of ontology item" ;
    rdfs:isDefinedBy : .

:ItemOfOntologyContainer a owl:Restriction ;
    owl:onProperty sioc:has_container ;
    owl:hasValue <model/ontologies/> ;
    rdfs:label "Has ontology container" ;
    rdfs:isDefinedBy : .

:Restriction a rdfs:Class ;
    rdfs:subClassOf lsm:Restriction, :TopicOfRestrictionItem ;
    ldt:path "{isPrimaryTopicOf.slug}/" ;
    ldt:fragment "this" ;
    rdfs:label "Restriction" ;
    rdfs:isDefinedBy : .

:RestrictionItem a rdfs:Class ;
    rdfs:subClassOf :Item, :ItemOfRestrictionContainer ;
    rdfs:label "Restriction item" ;
    rdfs:isDefinedBy : .

:TopicOfRestrictionItem a owl:Restriction ;
    owl:onProperty foaf:isPrimaryTopicOf ;
    owl:allValuesFrom :RestrictionItem ;
    rdfs:label "Topic of restriction item" ;
    rdfs:isDefinedBy : .

:ItemOfRestrictionContainer a owl:Restriction ;
    owl:onProperty sioc:has_container ;
    owl:hasValue <model/restrictions/> ;
    rdfs:label "Has restriction container" ;
    rdfs:isDefinedBy : .

:Authorization a rdfs:Class ;
    rdfs:subClassOf lacl:Authorization, :TopicOfAuthorizationItem ;
    ldt:path "{isPrimaryTopicOf.slug}/" ;
    ldt:fragment "this" ;
    apl:template :AuthorizationAgents ;
    rdfs:label "Authorization" ;
    rdfs:isDefinedBy : .

:AuthorizationAgents a apl:Content ;
    rdf:first :SelectAuthorizationAgents ;
    rdf:rest :AuthorizationAccessTo ;
    rdfs:isDefinedBy : .

:SelectAuthorizationAgents a sp:Select ;
    dct:title "Select agents" ;
    sp:text """
PREFIX  foaf: <http://xmlns.com/foaf/0.1/>
PREFIX  acl:  <http://www.w3.org/ns/auth/acl#>

SELECT DISTINCT  ?auth ?agent
WHERE
{ GRAPH ?authGraph
  { ?this  foaf:primaryTopic  ?auth .
    ?auth  acl:agent          ?agent
  }
}
""" ;
    rdfs:isDefinedBy : .

:AuthorizationAccessTo a apl:Content ;
    rdf:first :SelectAuthorizationAccessTo ;
    rdf:rest rdf:nil ;
    rdfs:isDefinedBy : .

:SelectAuthorizationAccessTo a sp:Select ;
    dct:title "Select access resources" ;
    sp:text """
PREFIX  foaf: <http://xmlns.com/foaf/0.1/>
PREFIX  acl:  <http://www.w3.org/ns/auth/acl#>

SELECT DISTINCT  ?auth ?accessTo
WHERE
{ GRAPH ?authGraph
  { ?this  foaf:primaryTopic  ?auth .
    ?auth  acl:accessTo       ?accessTo
  }
}
""" ;
    rdfs:isDefinedBy : .

:CreatorAuthorization a rdfs:Class ;
    rdfs:subClassOf lacl:CreatorAuthorization, :TopicOfAuthorizationItem ;
    ldt:path "{isPrimaryTopicOf.slug}/" ;
    ldt:fragment "this" ;
    rdfs:label "Creator authorization" ;
    rdfs:isDefinedBy : .

:AuthorizationItem a rdfs:Class ;
    rdfs:subClassOf :Item, :ItemOfAuthorizationContainer ;
    rdfs:label "Authorization item" ;
    rdfs:isDefinedBy : .

:TopicOfAuthorizationItem a owl:Restriction ;
    owl:onProperty foaf:isPrimaryTopicOf ;
    owl:allValuesFrom :AuthorizationItem ;
    rdfs:label "Topic of authorization item" ;
    rdfs:isDefinedBy : .

:ItemOfAuthorizationContainer a owl:Restriction ;
    owl:onProperty sioc:has_container ;
    owl:hasValue <acl/authorizations/> ;
    rdfs:label "Has authorization container" ;
    rdfs:isDefinedBy : .

:AuthorizationRequest a rdfs:Class ;
    rdfs:subClassOf lacl:AuthorizationRequest, :TopicOfAuthorizationRequestItem ;
    ldt:path "{isPrimaryTopicOf.slug}/" ;
    ldt:fragment "this" ;
    rdfs:label "Authorization request" ;
    rdfs:isDefinedBy : .

:AuthorizationRequestItem a rdfs:Class ;
    rdfs:subClassOf :Item, :ItemOfAuthorizationRequestContainer ;
    rdfs:label "Authorization request item" ;
    rdfs:isDefinedBy : .

:TopicOfAuthorizationRequestItem a owl:Restriction ;
    owl:onProperty foaf:isPrimaryTopicOf ;
    owl:allValuesFrom :AuthorizationRequestItem ;
    rdfs:label "Topic of authorization request item" ;
    rdfs:isDefinedBy : .

:ItemOfAuthorizationRequestContainer a owl:Restriction ;
    owl:onProperty sioc:has_container ;
    owl:hasValue <acl/authorization-requests/> ;
    rdfs:label "Has authorization request container" ;
    rdfs:isDefinedBy : .

:UserAccount a rdfs:Class ;
    rdfs:subClassOf lacl:UserAccount, :TopicOfUserAccountItem ;
    ldt:path "{isPrimaryTopicOf.slug}/" ;
    ldt:fragment "this" ;
    rdfs:label "User account" ;
    rdfs:isDefinedBy : .

:UserAccountItem a rdfs:Class ;
    rdfs:subClassOf :Item, :ItemOfUserAccountContainer ;
    rdfs:label "User account item" ;
    rdfs:isDefinedBy : .

:TopicOfUserAccountItem a owl:Restriction ;
    owl:onProperty foaf:isPrimaryTopicOf ;
    owl:allValuesFrom :UserAccountItem ;
    rdfs:label "Topic of user account item" ;
    rdfs:isDefinedBy : .

:ItemOfUserAccountContainer a owl:Restriction ;
    owl:onProperty sioc:has_container ;
    owl:hasValue <acl/users/> ;
    rdfs:label "Has user account container" ;
    rdfs:isDefinedBy : .

:Agent a rdfs:Class ;
    rdfs:subClassOf lacl:Agent, :TopicOfAgentItem ;
    ldt:path "{isPrimaryTopicOf.slug}/" ;
    ldt:fragment "this" ;
    rdfs:label "Agent" ;
    rdfs:isDefinedBy : .

:Person a rdfs:Class ;
    rdfs:subClassOf lacl:Person, :Agent, :TopicOfAgentItem ;
    rdfs:label "Person" ;
    rdfs:isDefinedBy : .

:AgentItem a rdfs:Class ;
    rdfs:subClassOf :Item, :ItemOfAgentContainer ;
    rdfs:label "Agent item" ;
    rdfs:isDefinedBy : .

:TopicOfAgentItem a owl:Restriction ;
    owl:onProperty foaf:isPrimaryTopicOf ;
    owl:allValuesFrom :AgentItem ;
    rdfs:label "Topic of agent item" ;
    rdfs:isDefinedBy : .

:ItemOfAgentContainer a owl:Restriction ;
    owl:onProperty sioc:has_container ;
    owl:hasValue <acl/agents/> ;
    rdfs:label "Has agent container" ;
    rdfs:isDefinedBy : .

:PublicKey a rdfs:Class ;
    rdfs:subClassOf lacl:PublicKey, :TopicOfPublicKeyItem ;
    ldt:path "{isPrimaryTopicOf.slug}/" ;
    ldt:fragment "this" ;
    rdfs:label "Public key" ;
    rdfs:isDefinedBy : .

:PublicKeyItem a rdfs:Class ;
    rdfs:subClassOf :Item, :ItemOfPublicKeyContainer ;
    rdfs:label "Public key item" ;
    rdfs:isDefinedBy : .

:TopicOfPublicKeyItem a owl:Restriction ;
    owl:onProperty foaf:isPrimaryTopicOf ;
    owl:allValuesFrom :PublicKeyItem ;
    rdfs:label "Topic of public key item" ;
    rdfs:isDefinedBy : .

:ItemOfPublicKeyContainer a owl:Restriction ;
    owl:onProperty sioc:has_container ;
    owl:hasValue <acl/public-keys/> ;
    rdfs:label "Has public key container" ;
    rdfs:isDefinedBy : .

:Group a rdfs:Class ;
    rdfs:subClassOf lacl:Group, :TopicOfGroupItem ;
    ldt:path "{isPrimaryTopicOf.slug}/" ;
    ldt:fragment "this" ;
    rdfs:label "Group" ;
    rdfs:isDefinedBy : .

:GroupItem a rdfs:Class ;
    rdfs:subClassOf :Item, :ItemOfGroupContainer ;
    rdfs:label "Group item" ;
    rdfs:isDefinedBy : .

:TopicOfGroupItem a owl:Restriction ;
    owl:onProperty foaf:isPrimaryTopicOf ;
    owl:allValuesFrom :GroupItem ;
    rdfs:label "Topic of group item" ;
    rdfs:isDefinedBy : .

:ItemOfGroupContainer a owl:Restriction ;
    owl:onProperty sioc:has_container ;
    owl:hasValue <acl/groups/> ;
    rdfs:label "Has group container" ;
    rdfs:isDefinedBy : .

# INSTANCES

:SignUp a rdfs:Class ;
    rdfs:subClassOf :Item ;
    rdfs:label "Sign up" ;
    rdfs:isDefinedBy : .

:RequestAccess a rdfs:Class ;
    rdfs:subClassOf :Item ;
    rdfs:label "Request access" ;
    rdfs:isDefinedBy : .

:OAuth2Login a rdfs:Class ;
    rdfs:subClassOf :Item ;
    rdfs:label "OAuth 2.0 login endpoint" ;
    rdfs:isDefinedBy : .

:AuthorizeGoogle a rdfs:Class ;
    rdfs:subClassOf :Item ;
    rdfs:label "OAuth 2.0 authorization endpoint" ;
    rdfs:isDefinedBy : .