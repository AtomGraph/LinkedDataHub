@prefix def:	<https://w3id.org/atomgraph/linkeddatahub/default#> .
@prefix ldh:	<https://w3id.org/atomgraph/linkeddatahub#> .
@prefix ac:	<https://w3id.org/atomgraph/client#> .
@prefix rdf:	<http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix xsd:	<http://www.w3.org/2001/XMLSchema#> .
@prefix dh:	<https://www.w3.org/ns/ldt/document-hierarchy#> .
@prefix sp:	<http://spinrdf.org/sp#> .
@prefix sioc:	<http://rdfs.org/sioc/ns#> .
@prefix foaf:	<http://xmlns.com/foaf/0.1/> .
@prefix dct:	<http://purl.org/dc/terms/> .

<>
{

    <> a def:Root ;
        dct:title "Root" ;
        dct:description "Root container" ;
        ldh:content <#select-children> .

    <#select-children> a ldh:Content ;
        rdf:first ldh:SelectChildren ;
        rdf:rest rdf:nil .

}

# CONTAINERS

<queries/>
{

    <queries/> a dh:Container ;
        dct:title "Queries" ;
        dct:description "SPARQL queries" ;
        ldh:content <queries/#select-children> .

    <queries/#select-children> a ldh:Content ;
        rdf:first ldh:SelectChildren ;
        rdf:rest rdf:nil .

}

<files/>
{

    <files/> a dh:Container ;
        dct:title "Files" ;
        dct:description "Uploaded files" ;
        ldh:content <files/#select-children> .

    <files/#select-children> a ldh:Content ;
        rdf:first ldh:SelectChildren ;
        rdf:rest rdf:nil .

}

<imports/>
{

    <imports/> a dh:Container ;
        dct:title "Imports" ;
        dct:description "Data imports" ;
        ldh:content <imports/#select-children> .

    <imports/#select-children> a ldh:Content ;
        rdf:first ldh:SelectChildren ;
        rdf:rest rdf:nil .

}

<geo/>
{

    <geo/> a dh:Item ;
        dct:title "Geo" ;
        dct:description "Geolocated resources" ;
        ldh:content <geo/#select-geo> .

    <geo/#select-geo> a ldh:Content ;
        rdf:first <geo/#select-geo-query> ;
        ac:mode ac:MapMode ;
        rdf:rest rdf:nil .

    <geo/#select-geo-query> a sp:Select ;
        dct:title "Select geo resources" ;
        sp:text """
    PREFIX  geo:  <http://www.w3.org/2003/01/geo/wgs84_pos#>
    PREFIX  dct:  <http://purl.org/dc/terms/>

    SELECT  DISTINCT ?resource
    WHERE
    { GRAPH ?graph
      { ?resource  geo:lat  ?lat ;
                  geo:long  ?long
        OPTIONAL
          { ?resource  a                    ?type }
        OPTIONAL
          { ?resource  dct:title  ?title }
      }
    }
    ORDER BY ?title
    """ .

}

<latest/>
{

    <latest/> a dh:Item ;
        dct:title "Latest" ;
        dct:description "Latest resources" ;
        ldh:content <latest/#select-latest> .

    <latest/#select-latest> a ldh:Content ;
        rdf:first <latest/#select-latest-query> ;
        rdf:rest rdf:nil .

    <latest/#select-latest-query> a sp:Select ;
        dct:title "Select latest" ;
        sp:text """
    PREFIX  dct:  <http://purl.org/dc/terms/>

    SELECT DISTINCT  ?dated
    WHERE
    { GRAPH ?graph
      { ?dated  dct:created  ?created }
    }
    ORDER BY DESC(?created)
    """ .

}

<charts/>
{

    <charts/> a dh:Container ;
        dct:title "Charts" ;
        dct:description "Saved charts" ;
        ldh:content <charts/#select-children> .

    <charts/#select-children> a ldh:Content ;
        rdf:first ldh:SelectChildren ;
        rdf:rest rdf:nil .

}


<apps/>
{

    <apps/> a dh:Container ;
        dct:title "Apps" ;
        dct:description "Linked Data applications" ;
        ldh:content <apps/#select-children> .

    <apps/#select-children> a ldh:Content ;
        rdf:first ldh:SelectChildren ;
        rdf:rest rdf:nil .

}

<services/>
{

    <services/> a dh:Container ;
        dct:title "Services" ;
        dct:description "SPARQL services" ;
        ldh:content <services/#select-children> .

    <services/#select-children> a ldh:Content ;
        rdf:first ldh:SelectChildren ;
        rdf:rest rdf:nil .

}