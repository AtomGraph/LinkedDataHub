@prefix def:	<https://w3id.org/atomgraph/linkeddatahub/default#> .
@prefix apl:	<https://w3id.org/atomgraph/linkeddatahub/domain#> .
@prefix rdf:	<http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix xsd:	<http://www.w3.org/2001/XMLSchema#> .
@prefix sp:	<http://spinrdf.org/sp#> .
@prefix dct:	<http://purl.org/dc/terms/> .
@prefix sioc:	<http://rdfs.org/sioc/ns#> .
@prefix foaf:	<http://xmlns.com/foaf/0.1/> .

<>
{

    <> a def:Root ;
        dct:title "Root" ;
        dct:description "Root container" ;
        apl:content <#content> .

    <#content> a apl:Content ;
        rdf:first """<div xmlns=\"http://www.w3.org/1999/xhtml\">
    <h2>Content</h2>
    <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Mauris malesuada eget justo tempus dictum. In sed velit vel mauris pellentesque aliquet. Quisque nec nulla cursus dolor auctor laoreet in non justo. In varius porttitor luctus. Curabitur lobortis urna a nisl eleifend aliquet. Maecenas dignissim pellentesque metus vel tincidunt. Nam vehicula malesuada odio, ut iaculis sem aliquet in. Curabitur suscipit nisi non ante malesuada, non sodales ipsum lobortis. Praesent id porttitor ligula. Suspendisse efficitur rutrum enim in laoreet.</p>
    <p>Sed auctor pulvinar eros, quis hendrerit mi gravida sed. Vestibulum mollis rutrum leo, in pulvinar augue convallis id. Donec luctus tincidunt ultrices. Suspendisse sit amet gravida massa. Quisque ut velit finibus, luctus lorem nec, aliquet lectus. Nullam rhoncus metus in mattis congue. Integer vitae volutpat sem. Aenean cursus, lorem sed pellentesque accumsan, enim justo lacinia urna, sed ullamcorper augue nibh sed augue. Curabitur vel neque id sem imperdiet accumsan. Mauris sed iaculis eros. Pellentesque ac euismod ante, ac fringilla nibh. Nullam luctus blandit neque sit amet facilisis. Donec quis hendrerit felis. Duis efficitur ornare nisl.</p>
</div>"""^^<http://www.w3.org/1999/02/22-rdf-syntax-ns#XMLLiteral> ;
        rdf:rest rdf:nil .

}

# CONTAINERS

<queries/>
{

    <queries/> a def:Container ;
        dct:title "Queries" ;
        dct:description "SPARQL queries" .

}

<queries/default/>
{

    <queries/default/> a def:Container ;
        sioc:has_parent <queries/> ;
        dct:title "Default" ;
        dct:description "Default queries" .

}

<files/>
{

    <files/> a def:Container ;
        dct:title "Files" ;
        dct:description "Uploaded files" .

}

<imports/>
{

    <imports/> a def:Container ;
        dct:title "Imports" ;
        dct:description "Data imports" .

}

<geo/>
{

    <geo/> a def:Container ;
        dct:title "geo" ;
        dct:description "Geolocated resources" .

}

<latest/>
{

    <latest/> a def:Container ;
        dct:title "Latest" ;
        dct:description "Latest resources" .

}

<charts/>
{

    <charts/> a def:Container ;
        dct:title "Charts" ;
        dct:description "Saved charts" .

}

<services/>
{

    <services/> a def:Container ;
        dct:title "Services" ;
        dct:description "SPARQL services" .

}

# QUERIES

# select children

<queries/default/select-children/>
{

    <queries/default/select-children/> a def:Item ;
        sioc:has_container <queries/default/> ;
        dct:title "Select children" ;
        foaf:primaryTopic <queries/default/select-children/#this> .

    <queries/default/select-children/#this> a def:Select ;
        foaf:isPrimaryTopicOf <queries/default/select-children/> ;
        dct:title "Select children" ;
        sp:text """
    PREFIX  dct:  <http://purl.org/dc/terms/>
    PREFIX  foaf: <http://xmlns.com/foaf/0.1/>
    PREFIX  sioc: <http://rdfs.org/sioc/ns#>

    SELECT DISTINCT  ?child ?thing
    WHERE
    { GRAPH ?childGraph
      {   { ?child  sioc:has_parent  ?this }
        UNION
          { ?child  sioc:has_container  ?this }
        ?child  a                     ?Type
        OPTIONAL
          { ?child  dct:title  ?title }
        OPTIONAL
         { ?thing  foaf:isPrimaryTopicOf  ?child }
      }
    }
    ORDER BY ?title
    """ .

}

# select geo resources

<queries/default/select-geo-resources/>
{

    <queries/default/select-geo-resources/> a def:Item ;
        sioc:has_container <queries/default/> ;
        dct:title "Select geo resources" ;
        foaf:primaryTopic <queries/default/select-geo-resources/#this> .

    <queries/default/select-geo-resources/#this> a def:Select ;
        foaf:isPrimaryTopicOf <queries/default/select-geo-resources/> ;
        dct:title "Select geo resources" ;
        sp:text """
    PREFIX  geo:  <http://www.w3.org/2003/01/geo/wgs84_pos#>
    PREFIX  dct:  <http://purl.org/dc/terms/>

    SELECT  DISTINCT ?resource
    WHERE
    { GRAPH ?graph
      { ?resource  geo:lat  ?lat ;
                  geo:long  ?long
        OPTIONAL
          { ?resource  a                    ?type }
        OPTIONAL
          { ?resource  dct:title  ?title }
      }
    }
    ORDER BY ?title
    """ .

}

# select latest

<queries/default/select-latest/>
{

    <queries/default/select-latest/> a def:Item ;
        sioc:has_container <queries/default/> ;
        dct:title "Select latest" ;
        foaf:primaryTopic <queries/default/select-latest/#this> .

    <queries/default/select-latest/#this> a def:Select ;
        foaf:isPrimaryTopicOf <queries/default/select-latest/> ;
        dct:title "Select latest" ;
        sp:text """
    PREFIX  dct:  <http://purl.org/dc/terms/>

    SELECT DISTINCT  ?dated
    WHERE
    { GRAPH ?graph
      { ?dated  dct:created  ?created }
    }
    ORDER BY DESC(?created)
    """ .

}

# select labelled

<queries/default/select-labelled/>
{

    <queries/default/select-labelled/> a def:Item ;
        sioc:has_container <queries/default/> ;
        dct:title "Select labelled" ;
        foaf:primaryTopic <queries/default/select-labelled/#this> .

    <queries/default/select-labelled/#this> a def:Select ;
        dct:title "Select labelled" ;
        sp:text """
    PREFIX  dct:  <http://purl.org/dc/terms/>
    PREFIX  rdf:  <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
    PREFIX  skos: <http://www.w3.org/2004/02/skos/core#>
    PREFIX  rdfs: <http://www.w3.org/2000/01/rdf-schema#>
    PREFIX  foaf: <http://xmlns.com/foaf/0.1/>
    PREFIX  sioc: <http://rdfs.org/sioc/ns#>
    PREFIX  dc:   <http://purl.org/dc/elements/1.1/>

    SELECT DISTINCT  ?resource
    WHERE
      {   { ?resource  a  ?Type .
            ?resource (((((((rdfs:label|dc:title)|dct:title)|foaf:name)|foaf:givenName)|foaf:familyName)|sioc:name)|skos:prefLabel)|sioc:content ?label
            FILTER isURI(?resource)
          }
        UNION
          { GRAPH ?graph
              { ?resource  a  ?Type .
                ?resource (((((((rdfs:label|dc:title)|dct:title)|foaf:name)|foaf:givenName)|foaf:familyName)|sioc:name)|skos:prefLabel)|sioc:content ?label
                FILTER isURI(?resource)
              }
          }
      }
    """ .

}