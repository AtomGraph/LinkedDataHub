@prefix def:	<https://w3id.org/atomgraph/linkeddatahub/default#> .
@prefix apl:	<https://w3id.org/atomgraph/linkeddatahub/domain#> .
@prefix rdf:	<http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix xsd:	<http://www.w3.org/2001/XMLSchema#> .
@prefix sp:	<http://spinrdf.org/sp#> .
@prefix dct:	<http://purl.org/dc/terms/> .
@prefix sioc:	<http://rdfs.org/sioc/ns#> .
@prefix foaf:	<http://xmlns.com/foaf/0.1/> .

<>
{

    <> a def:Root ;
        dct:title "Root" ;
        dct:description "Root container" .

}

# CONTAINERS

<queries/>
{

    <queries/> a def:Container ;
        dct:title "Queries" ;
        dct:description "SPARQL queries" .

}

<queries/default/>
{

    <queries/default/> a def:Container ;
        sioc:has_parent <queries/> ;
        dct:title "Default" ;
        dct:description "Default queries" .

}

<files/>
{

    <files/> a def:Container ;
        dct:title "Files" ;
        dct:description "Uploaded files" .

}

<imports/>
{

    <imports/> a def:Container ;
        dct:title "Imports" ;
        dct:description "Data imports" .

}

<geo/>
{

    <geo/> a def:Item ;
        dct:title "Geo" ;
        dct:description "Geolocated resources" ;
        apl:content <geo/#id31036be3-4fb4-493b-bc2d-3ab98693acc9> .

    <geo/#id31036be3-4fb4-493b-bc2d-3ab98693acc9> a apl:Content ;
        rdf:first <queries/default/select-geo-resources/#this> ;
        rdf:rest rdf:nil .

}

<latest/>
{

    <latest/> a def:Item ;
        dct:title "Latest" ;
        dct:description "Latest resources" ;
        apl:content <latest/#id17e6a62e-d319-44e7-b4ac-f38e29d461e7> .

    <latest/#id17e6a62e-d319-44e7-b4ac-f38e29d461e7> a apl:Content ;
        rdf:first <queries/default/select-latest/#this> ;
        rdf:rest rdf:nil .

}

<charts/>
{

    <charts/> a def:Container ;
        dct:title "Charts" ;
        dct:description "Saved charts" .

}

<services/>
{

    <services/> a def:Container ;
        dct:title "Services" ;
        dct:description "SPARQL services" .

}

# QUERIES

# select geo resources

<queries/default/select-geo-resources/>
{

    <queries/default/select-geo-resources/> a def:Item ;
        sioc:has_container <queries/default/> ;
        dct:title "Select geo resources" ;
        foaf:primaryTopic <queries/default/select-geo-resources/#this> .

    <queries/default/select-geo-resources/#this> a def:Select ;
        dct:title "Select geo resources" ;
        sp:text """
    PREFIX  geo:  <http://www.w3.org/2003/01/geo/wgs84_pos#>
    PREFIX  dct:  <http://purl.org/dc/terms/>

    SELECT  DISTINCT ?resource
    WHERE
    { GRAPH ?graph
      { ?resource  geo:lat  ?lat ;
                  geo:long  ?long
        OPTIONAL
          { ?resource  a                    ?type }
        OPTIONAL
          { ?resource  dct:title  ?title }
      }
    }
    ORDER BY ?title
    """ .

}

# select latest

<queries/default/select-latest/>
{

    <queries/default/select-latest/> a def:Item ;
        sioc:has_container <queries/default/> ;
        dct:title "Select latest" ;
        foaf:primaryTopic <queries/default/select-latest/#this> .

    <queries/default/select-latest/#this> a def:Select ;
        dct:title "Select latest" ;
        sp:text """
    PREFIX  dct:  <http://purl.org/dc/terms/>

    SELECT DISTINCT  ?dated
    WHERE
    { GRAPH ?graph
      { ?dated  dct:created  ?created }
    }
    ORDER BY DESC(?created)
    """ .

}